{"version":3,"file":"static/js/552.e5224ad0.chunk.js","mappings":"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","sources":["components/helpers/GenresData/fetchMovieForPages.js","page/Genre/Genre.jsx"],"sourcesContent":["import { fetchFilmsByGenre } from \"../../api/fetchFilms\";\n\nexport const fetchMovieForPages = async (\n  genreId,\n  abortController,\n  page,\n  per_page\n) => {\n  const movies = await fetchFilmsByGenre(genreId, abortController, page);\n  // movies.length\n  console.log(\"movies length: \", movies.length);\n\n  if (per_page === 1) {\n    const moviesForPage1 = movies.filter(\n      ({ vote_count }) => vote_count >= 1000\n    );\n    return moviesForPage1;\n  } else if (per_page === 2) {\n    const moviesForPage2 = movies.filter(\n      ({ vote_count }) => vote_count < 1000 && vote_count >= 200\n    );\n    return moviesForPage2;\n  } else if (per_page === 3) {\n    const moviesForPage3 = movies.filter(\n      ({ vote_count }) => vote_count < 1000 && vote_count < 200\n    );\n    return moviesForPage3;\n  }\n};\n","import { useEffect } from \"react\";\nimport { useState } from \"react\";\nimport { useRef } from \"react\";\nimport { Link, useLocation, useParams } from \"react-router-dom\";\nimport { MoviePreview } from \"../../components/helpers/MoviePreview/MoviePreview\";\nimport { Loader } from \"../../components/Loader/Loader\";\nimport { getGenres } from \"../../components/helpers/GenresData/getGenres\";\nimport \"../Genre/Genre.css\";\nimport { fetchMovieForPages } from \"../../components/helpers/GenresData/fetchMovieForPages\";\nimport {\n  ScrollToBottom,\n  ScrollToHalf,\n  ScrollToTop,\n} from \"../../components/helpers/ScrollToTop/ScrollToTop\";\n\nconst Genre = () => {\n  const defaultPage = 1;\n  const { genreId } = useParams();\n  const { movieId } = useParams(); //! STRING!!!!! ЗАВЖДИ робити конвертування у бажаний тип\n\n  const location = useLocation(); // Ця location в state отримує собі звідки прийшов (з Movies Details прокидую \"пропом\" в state)\n  const altPath = `/movies/${movieId}`;\n  const backLinkLocationRef = useRef(location.state?.from ?? altPath); //Якщо є локація, йди туди, як ні, повернись на сторінку фільму звідки прийшов\n\n  const altPathGenresPage = `/genres`;\n  // & По факту це зайве, бо так і так назад це завжди до /genres якщо не з фільма\n  // const backLinkLocationRefGenresPage = useRef(\n  //   location.state?.from ?? altPathGenresPage\n  // );\n\n  // Handling state\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [films, setFilms] = useState([]);\n  const [page, setPage] = useState(1);\n  const [genreName, setGenreName] = useState(null);\n  const [isLoadMore, setIsLoadMore] = useState(false);\n  const [isLoadMoreData, setIsLoadMoreData] = useState(false);\n\n  useEffect(() => {\n    const abortController = new AbortController();\n\n    async function getFilmsByGenre() {\n      try {\n        setIsLoading(true);\n        const filmsForPage1 = await fetchMovieForPages(\n          genreId,\n          abortController,\n          defaultPage,\n          1\n        );\n        setFilms(filmsForPage1);\n        setIsLoadMore(true);\n        setPage(2);\n\n        setError(null);\n      } catch (error) {\n        if (error.message === \"canceled\") return;\n        setError(\n          \"Something went wrong, try reloading page, if it doesnt help, there is no info about other films of this actor\"\n        );\n      } finally {\n        setIsLoading(false);\n      }\n    }\n    getFilmsByGenre();\n\n    return () => {\n      abortController.abort();\n    };\n  }, [genreId]);\n\n  useEffect(() => {\n    const genreTitle = getGenres([Number(genreId)]); //! STRING!!!!!\n    // [{id: 28, name: 'Action'}]\n    setGenreName(genreTitle[0].name);\n  }, [genreId]);\n\n  async function onLoadMore() {\n    setIsLoadMore(false);\n    setIsLoadMoreData(true);\n    const abortController = new AbortController();\n\n    if (page === 2) {\n      const filmsForPage2 = await fetchMovieForPages(\n        genreId,\n        abortController,\n        page,\n        2\n      );\n      setFilms((prevFilms) => [...prevFilms, ...filmsForPage2]);\n    } else if (page === 3) {\n      const filmsForPage3 = await fetchMovieForPages(\n        genreId,\n        abortController,\n        page,\n        3\n      );\n      setFilms((prevFilms) => [...prevFilms, ...filmsForPage3]);\n    }\n\n    setPage((prevPage) => prevPage + 1);\n\n    page !== 3 ? setIsLoadMore(true) : setIsLoadMore(false); // After second request we habe prohibid load more films (they arent famous enough)\n    setIsLoadMoreData(false);\n  }\n\n  return (\n    <>\n      {/* {backLinkLocationRef.current !== '/movies' ? (\n        <Link to={backLinkLocationRef.current} className=\"go-back-link\">\n          Go back\n        </Link>\n      ) : (\n        <Link to={altPath} className=\"go-back-link\">\n          Go back(fixed)\n        </Link>\n      )} */}\n\n      <Link\n        to={movieId ? backLinkLocationRef.current : altPathGenresPage}\n        className=\"go-back-link\"\n      >\n        Go back\n      </Link>\n      <h2 className=\"genre-list-title header-page-title\">\n        Films with <span className=\"genre-list-title-name\">{genreName}</span>{\" \"}\n        genre\n      </h2>\n      {films.length !== 0 && (\n        <div className=\"scroll_wrapper\">\n          <ScrollToBottom />\n          <ScrollToHalf />\n        </div>\n      )}\n      {error && (\n        <>\n          <h2 className=\"error\">{error}</h2>\n        </>\n      )}\n      {isLoading && <Loader />}\n      {films.length !== 0 ? (\n        <MoviePreview films={films} movieId={movieId} />\n      ) : (\n        !isLoading && <Loader />\n      )}\n      {isLoadMore && !isLoading ? (\n        <button type=\"button\" className=\"genre-btn-load\" onClick={onLoadMore}>\n          Load more\n        </button>\n      ) : isLoadMoreData && !isLoading && films.length !== 0 ? (\n        <>\n          <Loader />\n        </>\n      ) : null}\n      {films.length !== 0 && (\n        <div className=\"scroll_wrapper\">\n          <ScrollToTop />\n          <ScrollToHalf />\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default Genre;\n"],"names":["fetchMovieForPages","async","genreId","abortController","page","per_page","movies","fetchFilmsByGenre","console","log","length","filter","_ref","vote_count","_ref2","_ref3","Genre","_location$state$from","_location$state","useParams","movieId","location","useLocation","altPath","backLinkLocationRef","useRef","state","from","isLoading","setIsLoading","useState","error","setError","films","setFilms","setPage","genreName","setGenreName","isLoadMore","setIsLoadMore","isLoadMoreData","setIsLoadMoreData","useEffect","AbortController","filmsForPage1","message","getFilmsByGenre","abort","genreTitle","getGenres","Number","name","_jsxs","_Fragment","children","_jsx","Link","to","current","className","ScrollToBottom","ScrollToHalf","Loader","MoviePreview","type","onClick","filmsForPage2","prevFilms","filmsForPage3","prevPage","ScrollToTop"],"sourceRoot":""}